{% extends 'web/base.html' %}

{% block content %}
<h2>Add New Doctor</h2>

<form id="doctorForm">
    <label>Name:</label><br>
    <input type="text" id="name" required><br><br>
    <label>Specialization:</label><br>
    <input type="text" id="specialization" required><br><br>
    <label>Contact:</label><br>
    <input type="text" id="contact" required><br><br>
    <label>Email:</label><br>
    <input type="email" id="email" required><br><br>
    <button type="submit">Add Doctor</button>
</form>

<p id="doctorMessage" style="color: green;"></p>

<script>
document.getElementById('doctorForm').addEventListener('submit', async function(e) {
    e.preventDefault();

    const access_token = localStorage.getItem('access_token');
    if (!access_token) {
        alert('Please login first!');
        return;
    }

    const response = await fetch('/api/doctors/create/', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${access_token}`
        },
        body: JSON.stringify({
            name: document.getElementById('name').value,
            specialization: document.getElementById('specialization').value,
            contact: document.getElementById('contact').value,
            email: document.getElementById('email').value
        })
    });

    const data = await response.json();

    if (response.ok) {
        document.getElementById('doctorMessage').innerText = 'Doctor added successfully!';
        document.getElementById('doctorForm').reset();
    } else {
        document.getElementById('doctorMessage').innerText = JSON.stringify(data);
    }
});
</script>
{% endblock %}
